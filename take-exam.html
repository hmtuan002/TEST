<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tham gia thi - Hệ Thống Luyện Thi Văn Học</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Tham gia thi Văn học</h1>
            <div id="user-section">
                <span id="username-display"></span>
                <button id="logout-btn" class="btn btn-secondary">Đăng xuất</button>
            </div>
        </header>

        <main class="main-content">
            <div class="back-button">
                <button id="back-btn" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Quay lại</button>
            </div>

            <div class="exam-options-container">
                <h2>Chọn cách tham gia</h2>
                <div class="exam-options">
                    <div class="exam-option-card" id="join-exam-card">
                        <i class="fas fa-users"></i>
                        <h3>Tham gia đề thi của người khác</h3>
                        <p>Nhập link hoặc quét QR để tham gia đề thi</p>
                        <button class="btn">Bắt đầu</button>
                    </div>
                    <div class="exam-option-card" id="ai-exam-card">
                        <i class="fas fa-robot"></i>
                        <h3>Thi thử với đề AI</h3>
                        <p>Làm đề thi do AI tạo và được AI chấm điểm ngay</p>
                        <button class="btn">Bắt đầu</button>
                    </div>
                </div>
            </div>

            <!-- Join Exam Form (hidden by default) -->
            <div class="join-exam-form hidden" id="join-exam-form">
                <h2>Tham gia đề thi</h2>
                <div class="join-methods">
                    <div class="join-method" id="qr-method">
                        <i class="fas fa-qrcode"></i>
                        <h3>Quét QR code</h3>
                        <div class="qr-scanner-container">
                            <div id="qr-scanner"></div>
                            <button class="btn btn-secondary" id="stop-scan-btn">Dừng quét</button>
                        </div>
                    </div>
                    <div class="join-method" id="link-method">
                        <i class="fas fa-link"></i>
                        <h3>Nhập liên kết</h3>
                        <div class="form-group">
                            <label for="exam-link-input">Dán liên kết đề thi</label>
                            <input type="text" id="exam-link-input" placeholder="https://...">
                        </div>
                        <button class="btn" id="join-by-link-btn">Tham gia</button>
                    </div>
                </div>
                <button class="btn btn-secondary" id="back-to-options-btn">Quay lại</button>
            </div>

            <!-- AI Exam Form (hidden by default) -->
            <div class="ai-exam-form hidden" id="ai-exam-form">
                <h2>Thi thử với đề AI</h2>
                <div class="form-group">
                    <label for="ai-exam-topic">Chủ đề bạn muốn thi</label>
                    <input type="text" id="ai-exam-topic" placeholder="Ví dụ: Phân tích nhân vật Mị trong Vợ chồng A Phủ">
                </div>
                <div class="form-group">
                    <label for="ai-exam-duration">Thời gian làm bài (phút)</label>
                    <input type="number" id="ai-exam-duration" min="5" max="120" value="30">
                </div>
                <button class="btn" id="generate-ai-exam-btn">Tạo đề thi</button>
                <div class="ai-loading hidden" id="ai-exam-loading">
                    <i class="fas fa-spinner fa-spin"></i> Đang tạo đề thi...
                </div>
                <button class="btn btn-secondary" id="back-to-options-btn-ai">Quay lại</button>
            </div>

            <!-- Exam Taking Interface (hidden by default) -->
            <div class="exam-interface hidden" id="exam-interface">
                <div class="exam-header">
                    <h2 id="exam-taking-title">Tiêu đề đề thi</h2>
                    <div class="exam-timer" id="exam-timer">
                        <i class="fas fa-clock"></i> <span id="time-display">00:00:00</span>
                    </div>
                </div>
                <div class="exam-description" id="exam-taking-description">
                    Mô tả đề thi
                </div>
                <div class="student-info-form" id="student-info-form">
                    <div class="form-group">
                        <label for="student-name">Họ và tên</label>
                        <input type="text" id="student-name" placeholder="Nhập họ và tên của bạn">
                    </div>
                    <button class="btn" id="start-exam-btn">Bắt đầu làm bài</button>
                </div>
                <div class="exam-questions hidden" id="exam-questions">
                    <!-- Questions will be loaded here -->
                </div>
                <div class="exam-footer hidden" id="exam-footer">
                    <button class="btn" id="submit-exam-btn">Nộp bài</button>
                    <div class="progress-info">
                        <span id="answered-count">0</span>/<span id="total-questions">0</span> câu đã làm
                    </div>
                </div>
            </div>

            <!-- Exam Results (hidden by default) -->
            <div class="exam-results hidden" id="exam-results">
                <h2>Kết quả bài thi</h2>
                <div class="result-summary">
                    <div class="result-card">
                        <h3 id="result-student-name">Nguyễn Văn A</h3>
                        <p>Đề thi: <span id="result-exam-title">Tiêu đề đề thi</span></p>
                    </div>
                    <div class="result-card">
                        <div class="score-display">
                            <span id="result-score">0</span>/<span id="result-total">0</span>
                            <span class="score-text">điểm</span>
                        </div>
                    </div>
                </div>
                <div class="result-details" id="result-details">
                    <!-- Result details will be loaded here -->
                </div>
                <button class="btn" id="back-to-dashboard-btn">Quay về trang chủ</button>
            </div>
        </main>

        <footer class="footer">
            <p>© 2025 Hệ Thống Luyện Thi Văn Học</p>
        </footer>
    </div>

    <script src="js/firebase.js"></script>
    <script src="js/auth.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.min.js"></script>
    <script src="js/take-exam.js"></script>
    <script>
        // Back button functionality
        document.getElementById('back-btn').addEventListener('click', () => {
            window.location.href = 'index.html';
        });
    </script>
</body>
</html>